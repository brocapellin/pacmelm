<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><script type="text/javascript" src="resources/elm-runtime-0.12.3.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   "use strict";
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Gfx = Elm.Gfx.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var World = Elm.World.make(_elm);
   var _op = {};
   var main = A2(Signal._op["~"],
   A2(Signal._op["<~"],
   Gfx.renderResult,
   Window.dimensions),
   World.world);
   _elm.Main.values = {_op: _op
                      ,main: main};
   return _elm.Main.values;
};Elm.Gfx = Elm.Gfx || {};
Elm.Gfx.make = function (_elm) {
   "use strict";
   _elm.Gfx = _elm.Gfx || {};
   if (_elm.Gfx.values)
   return _elm.Gfx.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Gfx";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Line = Elm.Line.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var World = Elm.World.make(_elm);
   var _op = {};
   var fmod = F2(function (x,y) {
      return x - Basics.toFloat(Basics.floor(x / y)) * y;
   });
   var toPixels = function (units) {
      return 40.0 * units;
   };
   var levelPart = function (segment) {
      return function () {
         var $ = function () {
            var _v0 = segment.axis;
            switch (_v0.ctor)
            {case "X":
               return {ctor: "_Tuple2"
                      ,_0: segment.start.x + segment.length * 0.5
                      ,_1: segment.start.y};
               case "Y":
               return {ctor: "_Tuple2"
                      ,_0: segment.start.x
                      ,_1: segment.start.y + segment.length * 0.5};}
            _E.Case($moduleName,
            "between lines 88 and 95");
         }(),
         x = $._0,
         y = $._1;
         var part = function () {
            var _v1 = segment.axis;
            switch (_v1.ctor)
            {case "X":
               return A2(Graphics.Collage.rect,
                 toPixels(segment.length),
                 1.0);
               case "Y":
               return A2(Graphics.Collage.rect,
                 1.0,
                 toPixels(segment.length));}
            _E.Case($moduleName,
            "between lines 85 and 88");
         }();
         return Graphics.Collage.move({ctor: "_Tuple2"
                                      ,_0: toPixels(x)
                                      ,_1: toPixels(y)})(Graphics.Collage.filled(Color.white)(part));
      }();
   };
   var pacman = function (state) {
      return function () {
         var eatingSpeed = 0.4;
         var halfMouthSize = 0.6;
         var bodySize = toPixels(1.0);
         var mouthEnds = A2(fmod,
         state.worldTime,
         eatingSpeed) * halfMouthSize / eatingSpeed * bodySize;
         var rotation = function () {
            var _v2 = state.pacman.orientation;
            switch (_v2.ctor)
            {case "Down": return 90;
               case "Left": return 0;
               case "Right": return 180;
               case "Up": return 270;}
            _E.Case($moduleName,
            "between lines 57 and 63");
         }();
         var mouth = Graphics.Collage.filled(Color.black)(Graphics.Collage.polygon(_L.fromArray([{ctor: "_Tuple2"
                                                                                                 ,_0: (0 - bodySize) * 0.6
                                                                                                 ,_1: mouthEnds}
                                                                                                ,{ctor: "_Tuple2"
                                                                                                 ,_0: (0 - bodySize) * 0.6
                                                                                                 ,_1: 0 - mouthEnds}
                                                                                                ,{ctor: "_Tuple2"
                                                                                                 ,_0: bodySize * 0.25
                                                                                                 ,_1: 0.0}])));
         var body = Graphics.Collage.filled(Color.lightYellow)(Graphics.Collage.circle(bodySize * 0.5));
         return Graphics.Collage.rotate(Basics.degrees(rotation))(Graphics.Collage.move({ctor: "_Tuple2"
                                                                                        ,_0: toPixels(state.pacman.position.x)
                                                                                        ,_1: toPixels(state.pacman.position.y)})(Graphics.Collage.group(_L.fromArray([body
                                                                                                                                                                     ,mouth]))));
      }();
   };
   var resultObjects = F3(function (windowWidth,
   windowHeight,
   state) {
      return function () {
         var background = Graphics.Collage.filled(Color.black)(A2(Graphics.Collage.rect,
         Basics.toFloat(windowWidth),
         Basics.toFloat(windowHeight)));
         return _L.append(_L.fromArray([background
                                       ,pacman(state)]),
         A2(List.map,
         levelPart,
         World.level));
      }();
   });
   var renderResult = F2(function (_v3,
   state) {
      return function () {
         switch (_v3.ctor)
         {case "_Tuple2":
            return A2(Graphics.Collage.collage,
              _v3._0,
              _v3._1)(A3(resultObjects,
              _v3._0,
              _v3._1,
              state));}
         _E.Case($moduleName,
         "between lines 34 and 35");
      }();
   });
   _elm.Gfx.values = {_op: _op
                     ,renderResult: renderResult
                     ,resultObjects: resultObjects
                     ,pacman: pacman
                     ,toPixels: toPixels
                     ,fmod: fmod
                     ,levelPart: levelPart};
   return _elm.Gfx.values;
};Elm.World = Elm.World || {};
Elm.World.make = function (_elm) {
   "use strict";
   _elm.World = _elm.World || {};
   if (_elm.World.values)
   return _elm.World.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "World";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Input = Elm.Input.make(_elm);
   var Line = Elm.Line.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var WorldTime = Elm.WorldTime.make(_elm);
   var _op = {};
   var level = _L.fromArray([A4(Line.segment,
                            -5.0,
                            -5.0,
                            10.0,
                            Line.X)
                            ,A4(Line.segment,
                            -5.0,
                            5.0,
                            10.0,
                            Line.X)
                            ,A4(Line.segment,
                            -5.0,
                            -5.0,
                            10.0,
                            Line.Y)
                            ,A4(Line.segment,
                            5.0,
                            -5.0,
                            10.0,
                            Line.Y)]);
   var Down = {ctor: "Down"};
   var Right = {ctor: "Right"};
   var Up = {ctor: "Up"};
   var Left = {ctor: "Left"};
   var newPacman = function (state) {
      return function () {
         var velocity = 0.4;
         var $ = {ctor: "_Tuple2"
                 ,_0: Basics.round(state.input.move.x)
                 ,_1: Basics.round(state.input.move.y)},
         gameX = $._0,
         gameY = $._1;
         var oldPacman = state.pacman;
         var newOrientation = function () {
            var _v0 = {ctor: "_Tuple2"
                      ,_0: gameX
                      ,_1: gameY};
            switch (_v0.ctor)
            {case "_Tuple2": switch (_v0._0)
                 {case -1: switch (_v0._1)
                      {case 0: return Left;}
                      break;
                    case 0: switch (_v0._1)
                      {case -1: return Down;
                         case 1: return Up;}
                      break;
                    case 1: switch (_v0._1)
                      {case 0: return Right;}
                      break;}
                 break;}
            return oldPacman.orientation;
         }();
         var oldPosition = oldPacman.position;
         var newPosition = A2(Line.constrainToClosest,
         _U.replace([["x"
                     ,oldPosition.x + state.input.move.x * velocity]
                    ,["y"
                     ,oldPosition.y + state.input.move.y * velocity]],
         oldPosition),
         level);
         return _U.replace([["pacman"
                            ,_U.replace([["position"
                                         ,newPosition]
                                        ,["orientation"
                                         ,newOrientation]],
                            oldPacman)]],
         state);
      }();
   };
   var newState = F2(function (moment,
   state) {
      return function () {
         var newState = _U.replace([["worldTime"
                                    ,A2(WorldTime.newState,
                                    moment.worldTime,
                                    state.worldTime)]
                                   ,["input"
                                    ,A2(Input.newState,
                                    moment.input,
                                    state.input)]],
         state);
         return newPacman(newState);
      }();
   });
   var moment = function () {
      var combine = F2(function (worldTime,
      input) {
         return {_: {}
                ,input: Input.captureMoment(input)
                ,worldTime: WorldTime.captureMoment(worldTime)};
      });
      return A2(Signal._op["~"],
      A2(Signal._op["<~"],
      combine,
      WorldTime.moment),
      Input.moment);
   }();
   var initialState = {_: {}
                      ,input: Input.initialState
                      ,pacman: {_: {}
                               ,orientation: Left
                               ,position: {_: {}
                                          ,x: 0.0
                                          ,y: 0.0}}
                      ,worldTime: WorldTime.initialState};
   var world = A3(Signal.foldp,
   newState,
   initialState,
   moment);
   _elm.World.values = {_op: _op
                       ,world: world
                       ,initialState: initialState
                       ,moment: moment
                       ,newState: newState
                       ,newPacman: newPacman
                       ,level: level
                       ,Left: Left
                       ,Up: Up
                       ,Right: Right
                       ,Down: Down};
   return _elm.World.values;
};Elm.Input = Elm.Input || {};
Elm.Input.make = function (_elm) {
   "use strict";
   _elm.Input = _elm.Input || {};
   if (_elm.Input.values)
   return _elm.Input.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Input";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Keyboard = Elm.Keyboard.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var newState = F2(function (moment,
   state) {
      return function () {
         var $ = _U.eq(moment.wasd.x,
         state.wasd.x) && _U.eq(moment.wasd.y,
         state.wasd.y) ? {ctor: "_Tuple2"
                         ,_0: state.move.x
                         ,_1: state.move.y} : _U.eq(moment.wasd.x,
         0) || _U.eq(moment.wasd.y,
         0) ? {ctor: "_Tuple2"
              ,_0: Basics.toFloat(moment.wasd.x)
              ,_1: Basics.toFloat(moment.wasd.y)} : _U.eq(state.move.x,
         0) ? {ctor: "_Tuple2"
              ,_0: Basics.toFloat(moment.wasd.x)
              ,_1: 0.0} : {ctor: "_Tuple2"
                          ,_0: 0.0
                          ,_1: Basics.toFloat(moment.wasd.y)},
         moveX = $._0,
         moveY = $._1;
         return {_: {}
                ,move: {_: {},x: moveX,y: moveY}
                ,wasd: moment.wasd};
      }();
   });
   var captureMoment = function (wasd) {
      return {_: {},wasd: wasd};
   };
   var moment = Keyboard.wasd;
   var initialState = {_: {}
                      ,move: {_: {},x: 0.0,y: 0.0}
                      ,wasd: {_: {},x: 0,y: 0}};
   _elm.Input.values = {_op: _op
                       ,initialState: initialState
                       ,moment: moment
                       ,captureMoment: captureMoment
                       ,newState: newState};
   return _elm.Input.values;
};Elm.Line = Elm.Line || {};
Elm.Line.make = function (_elm) {
   "use strict";
   _elm.Line = _elm.Line || {};
   if (_elm.Line.values)
   return _elm.Line.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Line";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var Y = {ctor: "Y"};
   var X = {ctor: "X"};
   var mirrorAxis = function (a) {
      return function () {
         switch (a.ctor)
         {case "X": return Y;}
         return X;
      }();
   };
   var mirrorPoint = function (p) {
      return {_: {},x: p.y,y: p.x};
   };
   var mirrorLineSegment = function (ls) {
      return _U.replace([["start"
                         ,mirrorPoint(ls.start)]
                        ,["axis",mirrorAxis(ls.axis)]],
      ls);
   };
   var distance = F2(function (point,
   lineSegment) {
      return function () {
         var s = lineSegment;
         var se = s.start.x + s.length;
         var p = point;
         var disty = Basics.abs(p.y - s.start.y);
         var distx = _U.cmp(p.x,
         s.start.x) > -1 && _U.cmp(p.x,
         se) < 1 ? 0.0 : A2(Basics.min,
         Basics.abs(p.x - s.start.x),
         Basics.abs(p.x - se));
         return function () {
            var _v1 = lineSegment.axis;
            switch (_v1.ctor)
            {case "Y": return A2(distance,
                 mirrorPoint(point),
                 mirrorLineSegment(lineSegment));}
            return Basics.sqrt(Math.pow(distx,
            2.0) + Math.pow(disty,2.0));
         }();
      }();
   });
   var constrain = F2(function (point,
   lineSegment) {
      return function () {
         var s = lineSegment;
         var p = point;
         return function () {
            var _v2 = lineSegment.axis;
            switch (_v2.ctor)
            {case "Y":
               return mirrorPoint(A2(constrain,
                 mirrorPoint(p),
                 mirrorLineSegment(s)));}
            return {_: {}
                   ,x: function ($) {
                      return Basics.max(s.start.x)(Basics.min(p.x)($));
                   }(s.start.x + s.length)
                   ,y: s.start.y};
         }();
      }();
   });
   var constrainToClosest = F2(function (point,
   lineSegments) {
      return function () {
         var sortByDist = List.sortBy(Basics.fst);
         var withDist = List.map(function (l) {
            return {ctor: "_Tuple2"
                   ,_0: A2(distance,point,l)
                   ,_1: l};
         });
         var target = function ($) {
            return Basics.snd(List.head(sortByDist(withDist($))));
         }(lineSegments);
         return List.isEmpty(lineSegments) ? point : A2(constrain,
         point,
         target);
      }();
   });
   var segment = F4(function (x,
   y,
   length,
   axis) {
      return {_: {}
             ,axis: axis
             ,length: length
             ,start: {_: {},x: x,y: y}};
   });
   _elm.Line.values = {_op: _op
                      ,segment: segment
                      ,mirrorPoint: mirrorPoint
                      ,mirrorAxis: mirrorAxis
                      ,mirrorLineSegment: mirrorLineSegment
                      ,distance: distance
                      ,constrainToClosest: constrainToClosest
                      ,constrain: constrain
                      ,X: X
                      ,Y: Y};
   return _elm.Line.values;
};Elm.WorldTime = Elm.WorldTime || {};
Elm.WorldTime.make = function (_elm) {
   "use strict";
   _elm.WorldTime = _elm.WorldTime || {};
   if (_elm.WorldTime.values)
   return _elm.WorldTime.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "WorldTime";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var newState = F2(function (moment,
   state) {
      return state + Time.inSeconds(moment.timeDelta);
   });
   var captureMoment = function (timeDelta) {
      return {_: {}
             ,timeDelta: timeDelta};
   };
   var moment = Time.fps(25);
   var initialState = 0.0;
   _elm.WorldTime.values = {_op: _op
                           ,initialState: initialState
                           ,moment: moment
                           ,captureMoment: captureMoment
                           ,newState: newState};
   return _elm.WorldTime.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>